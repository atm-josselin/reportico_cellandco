<?xml version="1.0"?><Report><ReportQuery><Format><ReportTitle>Suivi des péremptions</ReportTitle><ReportDescription>Rapport des péremptions à 3 mois (en rouge les péremptions du mois).</ReportDescription><PageSize>.DEFAULT</PageSize><PageOrientation>.DEFAULT</PageOrientation><TopMargin></TopMargin><BottomMargin></BottomMargin><RightMargin></RightMargin><LeftMargin></LeftMargin><pdfFont></pdfFont><pdfFontSize></pdfFontSize><PreExecuteCode>NONE</PreExecuteCode><formBetweenRows>solidline</formBetweenRows><gridDisplay>.DEFAULT</gridDisplay><gridSortable>yes</gridSortable><gridSearchable>yes</gridSearchable><gridPageable>yes</gridPageable><gridPageSize>.DEFAULT</gridPageSize></Format><Datasource><SourceType>database</SourceType><SourceConnection><DatabaseType>mysql</DatabaseType><DatabaseName></DatabaseName><HostName></HostName><ServiceName></ServiceName><UserName></UserName><Password></Password></SourceConnection></Datasource><EntryForm><Query><TableSql></TableSql><WhereSql></WhereSql><GroupSql></GroupSql><RowSelection>all</RowSelection><SQL><QuerySql></QuerySql><SQLRaw>SELECT p.ref RefProduit,p.label Produit, llx_product_lot.batch Lot, DATE_FORMAT(llx_product_lot.sellby,'%m/%d/%Y') sellby, SUM(b.qty) Qty, GROUP_CONCAT(llx_entrepot.lieu) Entrepot
FROM llx_product as p, llx_product_batch as b, llx_product_stock, llx_product_lot ,llx_entrepot
WHERE p.rowid = llx_product_stock.fk_product 
AND llx_product_stock.fk_entrepot = llx_entrepot.rowid 
AND llx_product_lot.fk_product = p.rowid 
AND b.fk_product_stock = llx_product_stock.rowid
AND llx_product_lot.batch = b.batch 
AND llx_entrepot.rowid &lt;&gt; 40
AND llx_entrepot.statut = 1
AND b.qty &gt; 0
AND llx_product_lot.sellby Is Not Null
AND llx_product_lot.sellby &lt; DATE_ADD(CURDATE(), INTERVAL 3 MONTH)
GROUP BY  p.ref, llx_product_lot.batch, llx_product_lot.sellby, llx_product_stock.rowid
ORDER BY  llx_product_lot.sellby</SQLRaw></SQL><QueryColumns><QueryColumn><Name>RefProduit</Name><TableName>p</TableName><ColumnName>ref</ColumnName><ColumnType>char</ColumnType><ColumnLength>30</ColumnLength><Format><column_display>show</column_display><content_type>plain</content_type><ColumnStartPDF></ColumnStartPDF><justify>left</justify><ColumnWidthPDF></ColumnWidthPDF><ColumnWidthHTML></ColumnWidthHTML><column_title>Référence</column_title><tooltip></tooltip><group_header_label>0</group_header_label><group_header_label_xpos></group_header_label_xpos><group_header_data_xpos></group_header_data_xpos><group_trailer_label>0</group_trailer_label></Format></QueryColumn><QueryColumn><Name>Produit</Name><TableName>p</TableName><ColumnName>label</ColumnName><ColumnType>char</ColumnType><ColumnLength>30</ColumnLength><Format><column_display>show</column_display><content_type>plain</content_type><ColumnStartPDF></ColumnStartPDF><justify>left</justify><ColumnWidthPDF></ColumnWidthPDF><ColumnWidthHTML></ColumnWidthHTML><column_title></column_title><tooltip></tooltip><group_header_label>0</group_header_label><group_header_label_xpos></group_header_label_xpos><group_header_data_xpos></group_header_data_xpos><group_trailer_label>0</group_trailer_label></Format></QueryColumn><QueryColumn><Name>Lot</Name><TableName>llx_product_lot</TableName><ColumnName>batch</ColumnName><ColumnType>char</ColumnType><ColumnLength>30</ColumnLength><Format><column_display>show</column_display><content_type>plain</content_type><ColumnStartPDF></ColumnStartPDF><justify>center</justify><ColumnWidthPDF></ColumnWidthPDF><ColumnWidthHTML></ColumnWidthHTML><column_title></column_title><tooltip></tooltip><group_header_label>0</group_header_label><group_header_label_xpos></group_header_label_xpos><group_header_data_xpos></group_header_data_xpos><group_trailer_label>0</group_trailer_label></Format></QueryColumn><QueryColumn><Name>sellby</Name><TableName></TableName><ColumnName>DATE_FORMAT(llx_product_lot.sellby,'%m/%d/%Y')</ColumnName><ColumnType>char</ColumnType><ColumnLength>30</ColumnLength><Format><column_display>show</column_display><content_type>plain</content_type><ColumnStartPDF></ColumnStartPDF><justify>center</justify><ColumnWidthPDF></ColumnWidthPDF><ColumnWidthHTML></ColumnWidthHTML><column_title>Péremption</column_title><tooltip></tooltip><group_header_label>0</group_header_label><group_header_label_xpos></group_header_label_xpos><group_header_data_xpos></group_header_data_xpos><group_trailer_label>0</group_trailer_label></Format></QueryColumn><QueryColumn><Name>Qty</Name><TableName></TableName><ColumnName>SUM(b.qty)</ColumnName><ColumnType>char</ColumnType><ColumnLength>30</ColumnLength><Format><column_display>show</column_display><content_type>plain</content_type><ColumnStartPDF></ColumnStartPDF><justify>center</justify><ColumnWidthPDF></ColumnWidthPDF><ColumnWidthHTML></ColumnWidthHTML><column_title>Quantité en stock</column_title><tooltip></tooltip><group_header_label>0</group_header_label><group_header_label_xpos></group_header_label_xpos><group_header_data_xpos></group_header_data_xpos><group_trailer_label>0</group_trailer_label></Format></QueryColumn><QueryColumn><Name>Entrepot</Name><TableName></TableName><ColumnName>GROUP_CONCAT(llx_entrepot.lieu)</ColumnName><ColumnType>char</ColumnType><ColumnLength>30</ColumnLength><Format><column_display>show</column_display><content_type>plain</content_type><ColumnStartPDF></ColumnStartPDF><justify>left</justify><ColumnWidthPDF></ColumnWidthPDF><ColumnWidthHTML></ColumnWidthHTML><column_title></column_title><tooltip></tooltip><group_header_label>0</group_header_label><group_header_label_xpos></group_header_label_xpos><group_header_data_xpos></group_header_data_xpos><group_trailer_label>0</group_trailer_label></Format></QueryColumn><QueryColumn><Name>Mois</Name><TableName></TableName><ColumnName></ColumnName><ColumnType></ColumnType><ColumnLength></ColumnLength><Format><column_display>show</column_display><content_type>plain</content_type><ColumnStartPDF></ColumnStartPDF><justify>left</justify><ColumnWidthPDF></ColumnWidthPDF><ColumnWidthHTML></ColumnWidthHTML><column_title></column_title><tooltip></tooltip><group_header_label>0</group_header_label><group_header_label_xpos></group_header_label_xpos><group_header_data_xpos></group_header_data_xpos><group_trailer_label>0</group_trailer_label></Format></QueryColumn></QueryColumns><OrderColumns></OrderColumns><PreSQLS></PreSQLS></Query><Assignments><Assignment><AssignName>sellby</AssignName><AssignNameNew></AssignNameNew><Expression>apply_style('CELL', 'background-color', '#EDA9A9');</Expression><Condition>Date(&quot;M&quot;,strtotime({sellby})) == Date(&quot;M&quot;,time()) </Condition></Assignment><Assignment><AssignName>Mois</AssignName><AssignNameNew></AssignNameNew><Expression>Date(&quot;F o&quot;,strtotime({sellby}));</Expression><Condition></Condition></Assignment><Assignment><AssignName>sellby</AssignName><AssignNameNew></AssignNameNew><Expression>Date(&quot;d-M-Y&quot;,strtotime({sellby}));</Expression><Condition></Condition></Assignment></Assignments><Criteria></Criteria><Output><PageHeaders></PageHeaders><PageFooters></PageFooters><DisplayOrders><DisplayOrder><ColumnName>RefProduit</ColumnName><OrderNumber>1</OrderNumber></DisplayOrder><DisplayOrder><ColumnName>Produit</ColumnName><OrderNumber>2</OrderNumber></DisplayOrder><DisplayOrder><ColumnName>Lot</ColumnName><OrderNumber>3</OrderNumber></DisplayOrder><DisplayOrder><ColumnName>sellby</ColumnName><OrderNumber>4</OrderNumber></DisplayOrder><DisplayOrder><ColumnName>Qty</ColumnName><OrderNumber>5</OrderNumber></DisplayOrder><DisplayOrder><ColumnName>Mois</ColumnName><OrderNumber>6</OrderNumber></DisplayOrder><DisplayOrder><ColumnName>Entrepot</ColumnName><OrderNumber>7</OrderNumber></DisplayOrder></DisplayOrders><Groups><Group><GroupName>Mois</GroupName><BeforeGroupHeader>blankline</BeforeGroupHeader><AfterGroupHeader>blankline</AfterGroupHeader><BeforeGroupTrailer>blankline</BeforeGroupTrailer><AfterGroupTrailer>blankline</AfterGroupTrailer><GroupHeaders><GroupHeader><GroupHeaderColumn>Mois</GroupHeaderColumn><GroupHeaderCustom></GroupHeaderCustom><ShowInHTML>yes</ShowInHTML><ShowInPDF>yes</ShowInPDF></GroupHeader></GroupHeaders><GroupTrailers></GroupTrailers></Group></Groups><Graphs></Graphs></Output></EntryForm></ReportQuery></Report>